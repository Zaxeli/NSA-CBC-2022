source gdb_script.py 
x/gx *93824992876184
x/gx 93824992876184
help set
source gdb_script.py 
x/gx 93824992876184
set *(long *)93824992879000=15912251461769308592
set *{long *}93824992879000=15912251461769308592
set {long *}93824992879000=15912251461769308592
x/gx 93824992876184
x/2gx 93824992876184
x/2gx 93824992876184-8
source gdb_script.py 
x/2gx 93824992876184-8
x/xg 93824992881800
x/xg 93824992881808
x/xg 93824992881808+8
x/xg 93824992881808+8+8
x/10gx $shielded_private 
source gdb_script.py 
source gdb_script.py 
q
b sshkey_free
r
source gdb_script.py 
x/gx 0x5585d30d9bf0
x/gx 93824993421944
x/gx $shield_prekey
x/10gx $shield_prekey
p $miak
call sshkey_unshield_private($miak)
x/10gx $shielded_private 
x/10gx $miak->ed25519_sk 
x/10gx $miak->rsa
x/10gx $miak->dsa
bt
f 1
x *kp
x k
x *k
x pkp
x/gx 0x000055555566fb70
x/10gx pkp
k
f 1
disas sshkey_unshield_private 
vis_heap_chunks 
x/10gx $shield_prekey
x/175gx $shield_prekey
x/175gx $shield_prssekey
ctx
x/176gx $shield_prekey
x/1024gx $shield_prekey
x/10gx 0x555555674a50
b sshbuf_free
p &sshbuf_free
call sshkey_unshield_private($miak)
disas sshkey_unshield_private 
b *0x0000555555574849
call sshkey_unshield_private($miak)
bt
b sshkey_unshield_private
call sshkey_unshield_private($miak)
call sshkey_unshield_private($miak)
ni
ni
ni
ni
i b
r
source gdb_script.py 
ctx
call sshkey_unshield_private($miak)
ni
ni
r
call sshkey_unshield_private($miak)
ni
p $miak->shielded_private 
p $miak
p $miak->shielded_private
p $shielded_private
source gdb_script.py 
ctx
r
source gdb_script.py 
ctx
call sshkey_unshield_private($miak)
ni
p $miak->shielded_private 
p $miak->shield_prekey
ni
ni
n
r
source gdb_script.py 
ctx
call sshkey_unshield_private($miak)
ni
n
ni
ni
bt
x/20gx $shielded_private
x/20gx $shielded_private-0x10
x/20gx $shield_prekey-0x10
r
source gdb_script.py 
call sshkey_unshield_private($miak)
ni
x/20gx $shield_prekey-0x10
x/20gx $shielded_private-0x10
call sshkey_unshield_private($miak)
ni
n
prvbuf
p prvbuf
p &prvbuf
n
p &prvbuf
p prvbuf
n
p prvbuf
telescope prvbuf
n
p kswap
p prvbuf
n
c
c
ni
finish
n
finish
prvbuf
p prvbuf
n
n
c
c
c
c
c
bt
r
i b
delete 1 2
i b
b sshkey_free
c
r
source gdb_script.py 
call sshkey_unshield_private($miak)
c
c
bt
f 1
x *kp
x kp
x *kp
call sshkey_save_private(*kp, "/tmp/plaintext_private_key", "", "comment", 0, "\x00", 0)
c
bt
x kp*
x *kp
x 0x5555556841d0
r
source gdb_script.py 
call sshkey_unshield_private($miak)
c
bt
ctx
bt
f 1
vtx
ctx
i args
p $buf
b buf
p buf
telescope buf
telescope 0x555555683bc0
ctx
up
ctx
n
up
ctx
b *0x555555574851
delete
b *0x555555574851
c
ni
ni
n
ni
b *0x55555557488a
c
ni
p prvbuf
telescope prvbuf
ni
n
kp
p kp
telescope prvbuf
p keyiv
x/10gx keyiv
bt
b sshley_free
b sshkey_free
r
source gdb_script.py 
b cipher_init
call sshkey_unshield_private($miak)
ctx
i args
p key
x key
x/10gx key
x/10bx key
file
file ./openssh-8.9p1/ssh-keygen
q
b sshkey_free
r
source gdb_script.py 
p $miak
call sshkey_save_private($miak, "privatekeys/miak", "", "comment", 0, "\x00", 0)
bt
$miak
p $miak
r
source gdb_script.py 
p $miak
telescope sshkey_unshield_private 
telescope *sshkey_unshield_private 
telescope &sshkey_unshield_private 
x/30i &sshkey_unshield_private 
ctx
call sshkey_unshield_private($miak)
p $ik
p $miak
bt
f 1
p kp
x/10gx kp
x/10gx *kp
x/10gx **kp
kp
p kp
p kp->shielded_private 
p kp->shielded_len 
x *kp
x/10wx 0x00005585d30d50e0
x/10gx 0x00005585d30d50e0
